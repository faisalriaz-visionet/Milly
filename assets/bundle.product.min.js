window.REBASE=window.REBASE||{},REBASE.theme=REBASE.theme||{},function(e){e(function(){REBASE.theme.IS_PRODUCT_TEMPLATE=e("body").hasClass("product-template"),REBASE.theme.IS_PRODUCT_TEMPLATE&&REBASE.theme.bindProductControls(),REBASE.theme.is_mobile=window.innerWidth<1040}),REBASE.theme.handleizeStr=function(e){if(null==e)return"";e=e.toLowerCase();for(var t=['"',"'","\\","(",")","[","]"],i=0;i<t.length;++i)e=e.replace(t[i],"");return"-"==(e=e.replace(/\W+/g,"-")).charAt(e.length-1)&&(e=e.replace(/-+\z/,"")),"-"==e.charAt(0)&&(e=e.replace(/\A-+/,"")),e},REBASE.theme.appendToFilename=function(e,t){var i=e.lastIndexOf(".");return-1===i?e+t:e.substring(0,i)+t+e.substring(i)},REBASE.theme.unbindProductControls=function(){e(".product-header__reviews, .product-info__tabs a").off(".rbProduct")},REBASE.theme.initProductGallery=function(){REBASE.theme.product_photo_gallery=new Swiper(".gallery",{effect:"slide",loop:!0,speed:300,slidesPerView:1.75,centeredSlides:!0,navigation:{nextEl:".gallery-button__next",prevEl:".gallery-button__prev"}})},REBASE.theme.bindProductControls=function(){e(document).on("click",".product-qty__minus",function(t){t.preventDefault();var i=e("#quantity"),a=parseInt(i.val())-1;a>=1&&i.val(a)}),e(document).on("click",".product-qty__plus",function(t){t.preventDefault();var i=e("#quantity");i.val(parseInt(i.val())+1)}),REBASE.theme.initProductGallery(),product=new REBASE.theme.Product({$container:e("#add-to-cart-form")})},REBASE.theme.Product=function(){function t(t){var i,a;this.variants=null,this.$container=t.$container,this.data=JSON.parse(document.getElementById("product__json").innerHTML),this.dataNew=JSON.parse(document.getElementById("variant__inv").innerHTML),this.images=this.data.images,this.media=this.data.media,this.quickView=t.quickView||!1,this.settings={single_option_selector:".single-option-select",original_select_id:"select#product-select"},this.data?(this._initVariants(),"radio"===(a=(i=e(this.settings.single_option_selector,this.$container)).first().attr("type"))||"checkbox"===a?i.filter(":checked:first").trigger("change"):i.first().trigger("change")):console&&console.log("Missing product json data!")}return t.prototype=e.extend({},t.prototype,{_initVariants:function(){var e={$container:this.$container,enable_history_state:!this.quickView,single_option_selector:this.settings.single_option_selector,original_select_id:this.settings.original_select_id,product:this.data,quickView:this.quickView||!1};this.variants=new REBASE.theme.Variants(e),this.$container.on("variantChange",this._updateAddToCart.bind(this)),this.$container.on("variantPriceChange",this._updatePrice.bind(this)),this.$container.on("variantChange",this._updateColorLabel.bind(this)),!0===this.quickView?(this.$container.on("variantChange",this._updateQuickViewDetailsLink.bind(this)),this.$container.on("variantImageChange",this._updateQuickViewMedia.bind(this))):this.$container.on("variantImageChange",this._updateMedia.bind(this))},_updateColorLabel:function(t){e("#option-name--option1 span").text(t.variant.option1)},_updatePrice:function(t){var i=t.variant;e(".product-price:not(.product-price--old)").html(Shopify.formatMoney(i.price,"")),i.price<i.compare_at_price?(e(".product-price--old").html(Shopify.formatMoney(i.compare_at_price,"")),e(".product-price:not(.product-price--old)").addClass("product-price--on-sale"),e(".product__final-sale").addClass("visible")):(e(".product-price--old").html(""),e(".product-price:not(.product-price--old)").removeClass("product-price--on-sale"),e(".product__final-sale").removeClass("visible"))},_updateAddToCart:function(t){var i=t.variant,a=t.all_variants_match_option1,n=e(t.target),r=n.attr("type"),o=e("#add-to-cart"),s=e("#add-to-cart-text"),d=this.dataNew,l=this.data.tags;if(i)if(i.available){for(var c=!1,p=0;p<d.variants.length;p++)d.variants[p].id==i.id&&d.variants[p].inv<=0&&(c=!0);c?(o.removeClass("disabled").removeAttr("disabled"),s.text("Pre-order")):(o.removeClass("disabled").removeAttr("disabled"),s.text(s.data("add-to-cart-text")))}else o.addClass("disabled").attr("disabled","disabled"),s.text(s.data("sold-out-text"));else o.addClass("disabled").attr("disabled","disabled"),s.text("Not Available");if("radio"===r||"checkbox"===r){n.parent(".swatch-element").addClass("selected-swatch").siblings().removeClass("selected-swatch");var h=e('input[data-index="option2"]'),u=h.map(function(){return e(this).val()}).get(),_=e.map(u,function(t){var i=!1;return e.each(a,function(e,a){a.option2===t&&a.available&&(i=!0)}),i?void 0:t});h.parent(".swatch-element").removeClass("swatch--unavailable"),h.parent(".dropdown__option").removeClass("dropdown__option--sold-out").find(".dropdown__option-label span").remove(),h.parent(".dropdown__option").find(".dropdown__option-label").removeClass("back-in-stock-trigger"),e.each(_,function(t,i){h.each(function(){var t=e(this);t.val()===i&&(t.parent(".swatch-element").addClass("swatch--unavailable"),t.parent(".dropdown__option").addClass("dropdown__option--sold-out"),t.parent(".dropdown__option").find(".dropdown__option-label").append("<span>Sold Out </span>"),l.includes("final-sale:1")||(t.parent(".dropdown__option").find(".dropdown__option-label").addClass("back-in-stock-trigger"),t.parent(".dropdown__option").find(".dropdown__option-label").append("<span>Notify Me When Available</span>")))})})}},_buildImgUrl:function(e,t){var i=t||"900x",a=(e=e.split("?")[0]).match(/(\.[\w\d_-]+)$/i).index;return e.slice(0,a)+"_"+i+e.slice(a)},_buildImage:function(e){var t=document.createElement("div"),i=document.createElement("a"),a=document.createElement("img");return i.href=this._buildImgUrl(e.src,"3000x"),i.classList.add("MagicZoom"),a.src=this._buildImgUrl(e.src,"900x"),a.srcset=this._buildImgUrl(e.src,"900x")+" 1x, "+this._buildImgUrl(e.src,"1800x")+" 2x",t.classList.add("swiper-slide"),i.appendChild(a),t.appendChild(i),t},_buildVideo:function(e){var t=document.createElement("figure"),i=document.createElement("video");return i.playsinline=!0,i.controls=!0,i.poster=e.preview_image.src,e.sources.forEach(function(e){var t=document.createElement("source");t.src=e.url,t.type=e.mime_type,i.appendChild(t)}),t.classList.add("swiper-slide"),t.appendChild(i),t},_buildExternalVideo:function(e){var t=document.createElement("figure"),i=document.createElement("div"),a=document.createElement("iframe");return t.classList.add("swiper-slide"),i.classList.add("gallery-video-container"),a.title=e.alt?e.alt:this.data.title,a.allowfullscreen="allowfullscreen",a.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",a.frameborder="0",a.src="https://www.youtube.com/embed/"+e.external_id+"?controls=1&amp;enablejsapi=1&amp;modestbranding=1&amp;playsinline=1&amp;rel=0",i.appendChild(a),t.appendChild(i),t},_getMediaEl:function(e){var t=null;switch(e.media_type){case"image":t=this._buildImage(e);break;case"video":t=this._buildVideo(e);break;case"external_video":t=this._buildExternalVideo(e)}return t},_updateMedia:function(t){var i=t.variant,a=e(".product__part--gallery"),n=a.find(".swiper-container .swiper-wrapper");variant_media=this.data.media.filter(function(e){var t=e.src.match(/([^\/]+\.(jpg|png))/gi)[0].split("_");return REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(i.option1).replace("-","")||REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(i.option2).replace("-","")||REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(i.option3).replace("-","")}),n.fadeOut(200,function(){n.empty(),variant_media.forEach(function(e){n.append(this._getMediaEl(e))}.bind(this)),REBASE.theme.product_photo_gallery.destroy(),REBASE.theme.initProductGallery(),setTimeout(function(){a.addClass("visible"),n.addClass("visible"),n.fadeIn(200),MagicZoom.refresh()})}.bind(this))},_updateQuickViewMedia:function(t){var i,a=t.variant,n=e(".product-quickview__thumbs"),r=e(".product-quickview__image");i=this.data.media.filter(function(e){var t=e.src.match(/([^\/]+\.(jpg|png))/gi)[0].split("_");return REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(a.option1).replace("-","")||REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(a.option2).replace("-","")||REBASE.theme.handleizeStr(t[t.length-2]).replace("-","")===REBASE.theme.handleizeStr(a.option3).replace("-","")}),n.empty(),r.empty(),i.forEach(function(e,t){"image"==e.media_type&&n.append('<a href="#" data-src="'+Shopify.resizeImage(e.src,"1600x")+'"><img src="'+Shopify.resizeImage(e.src,"800x")+'" alt="'+e.alt+" Image "+t+'" /></a>')}),r.html('<img src="'+Shopify.resizeImage(i[0].src,"1600x")+'" alt="'+i[0].alt+'" />')},_updateQuickViewDetailsLink:function(t){var i=e(".view-details-btn",this.$container),a=i.attr("href").split("?")[0]+"?variant="+t.variant.id;i.attr("href",a)}}),t}(),REBASE.theme.Variants=function(){function t(t){this.$container=t.$container,this.product=t.product,this.single_option_selector=t.single_option_selector,this.original_select_id=t.original_select_id,this.enable_history_state=t.enable_history_state,this.current_variant={},this.quickView=t.quickView,e(this.single_option_selector,this.$container).on("change",this._onSelectChange.bind(this))}return t.prototype=e.extend({},t.prototype,{_getCurrentOptions:function(){var t=!1,i=e.map(e(this.single_option_selector,this.$container),function(i){var a=e(i),n=a.attr("type"),r={};return"radio"===n||"checkbox"===n?(t=!0,!!a[0].checked&&(r.value=a.val(),r.index=a.data("index"),r)):(r.value=a.val(),r.index=a.data("index"),r)});return t&&(i=i.filter(Boolean)),i},_getVariantFromOptions:function(){var t,i,a=this._getCurrentOptions(),n=this.product.variants;return i=e.grep(n,function(e){return a.every(function(t){return e[t.index]===t.value})}),t=e.grep(n,function(e){return e[a[0].index]===a[0].value}),{variant_match:i=i.length?i[0]:void 0,all_variants_match_option1:t}},_onSelectChange:function(t){var i,a=this._getVariantFromOptions();i=a.variant_match,this.$container.trigger({type:"variantChange",variant:i,all_variants_match_option1:a.all_variants_match_option1,target:t.target}),i?(this.quickView&&e(document).trigger({type:"variantChange",variant:i}),this._updateMasterSelect(i),this._updateImages(i),this._updatePrice(i),this._updateSKU(i),this.current_variant=i,this.enable_history_state&&this._updateHistoryState(i)):this.current_variant={}},_updateImages:function(e){var t=e.featured_image||{},i=this.current_variant.featured_image||{};e.featured_image&&t.src!==i.src&&this.$container.trigger({type:"variantImageChange",variant:e})},_updatePrice:function(e){e.price===this.current_variant.price&&e.compare_at_price===this.current_variant.compare_at_price||this.$container.trigger({type:"variantPriceChange",variant:e})},_updateSKU:function(e){e.sku!==this.current_variant.sku&&this.$container.trigger({type:"variantSKUChange",variant:e})},_updateHistoryState:function(e){if(history.replaceState&&e)window.location.protocol,window.location.host,window.location.pathname,e.id},_updateMasterSelect:function(t){e(this.original_select_id,this.$container).val(t.id).data("selected-variant-id",t.id),e("#product-supplier-style").text(e("option:selected",this.original_select_id,this.$container).data("variant-ss"))}}),t}()}(jQuery);